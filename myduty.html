<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My TSRTC Duty</title>
  <style>
    :root { --p:#1d4ed8; --bg:#f8fafc; --t:#1e293b; }
    body { margin:0; font-family:system-ui,sans-serif; background:var(--bg); padding:1rem; }
    #card {
      max-width:360px; margin:1.5rem auto; padding:1.8rem;
      background:white; border-radius:1.2rem; box-shadow:0 12px 30px rgba(0,0,0,.12);
      text-align:center;
    }
    h2 { margin:0 0 .6rem; color:var(--p); font-size:1.6rem; font-weight:700; }
    #name { font-size:1.35rem; font-weight:600; color:var(--p); margin-bottom:.4rem; }
    #staff { font-size:1.2rem; color:#555; margin-bottom:.8rem; }
    #duty { 
      margin:1.2rem 0; font-size:1.8rem; font-weight:800; 
      color:var(--t); min-height:3rem; line-height:1.3;
      text-shadow: 0 1px 2px rgba(0,0,0,.1);
    }
    #timer { font-size:1rem; color:#64748b; font-weight:500; }
    .hidden { display:none; }
  </style>
</head>
<body>

<div id="card">
  <h2>TSRTC Duty</h2>
  <div id="name">Your Name Here</div> <!-- CHANGE THIS LINE -->
  <div id="staff">Staff: 825955</div>
  <div id="duty">Loading…</div>
  <div id="timer"></div>
  <iframe id="loader" class="hidden" sandbox="allow-same-origin"></iframe>
</div>

<script>
  const STAFF = "825955";
  const URL   = "http://tgsrtcinfo.in/main/dm_award/cnd_duty.php";
  const SEL   = "table tr:nth-child(2) td:nth-child(2)";

  const dutyEl  = document.getElementById('duty');
  const timerEl = document.getElementById('timer');
  const iframe  = document.getElementById('loader');
  let timer;

  function fetchDuty() {
    iframe.src = `${URL}?cndno=${STAFF}&t=${Date.now()}`;
  }

  iframe.onload = () => {
    try {
      const doc = iframe.contentDocument;
      const cell = doc.querySelector(SEL);
      const text = cell ? cell.innerText.trim() : "No duty";
      dutyEl.textContent = text || "—";
      startTimer();
    } catch(e) {
      dutyEl.textContent = "Check internet";
    }
  };

  function startTimer() {
    let s = 60;
    clearInterval(timer);
    timer = setInterval(() => {
      timerEl.textContent = `Auto-refresh in ${s}s`;
      if (--s < 0) { fetchDuty(); s = 60; }
    }, 1000);
  }

  // Start now
  fetchDuty();
</script>

</body>
</html>